# 获取人的数据条数分布

在将数据转换成内部数据后, 要得到人对应的数据条数的分布, 根据这个分布, 确定下一步基于人群数据条数的过滤范围。

获取每个人的数据条数, 把数据条数按照区间进行统计

应该是设计一个UDAF, 输入是(需要进行划分的列, 步长）

先得到每个人的数据条数, 如果设置的间隔是50, 让数据条数/50即可以知道当前这个人的数据条数有多少个50, 再根据每个人有多少个50聚合下, 就可以知道0个50的有多少人, 1个50的有多少人,2个50的有多少人, 那个50的有多少人。返回前100个（0-5000）条的数据分布。

```sql
select t.r as interval, count(*) as count from (
  select uuid, floor((count(*)/10)) as r
  from nanjing1_spatio_temporal_raw_data
  where date_p=20151229
  group by uuid) t
group by t.r
order by interval
limit 20
```

输入参数:
1 interval_range: 10
2 date_p = 20151229
3 limit范围: 前20

执行过程:

```


```
